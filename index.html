<html>
    <head>
        <meta charset="utf-8">
        <title>[FFXIV] FF14 Hunter</title>
        <script src="https://apis.google.com/js/api.js"></script>
        <style type="text/css">
            .tg  {border-collapse:collapse;border-spacing:0;border-color:#999;}
            .tg td{font-family:Arial, sans-serif;/*font-size:14px;*/padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#999;color:#444;background-color:#F7FDFA;}
            .tg th{font-family:Arial, sans-serif;/*font-size:14px;*/font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#999;color:#fff;background-color:#26ADE4;}
            .tg .tg-4a1m{/*font-size:10px;*/border-color:inherit;vertical-align:top}
            .tg .tg-s2sm{background-color:#D2E4FC;/*font-size:10px;*/border-color:inherit;vertical-align:top}
        </style>
    </head>
    <body>
        <script>
            gapi.load('client', initClient);
            var alphabet = ["A","B","C","D","E","F","G","H","I","J","K","L","M","N"];
            function initClient() {
                var API_KEY = 'AIzaSyAxFo4vumR9TLX-0-5zUaUbzXdY7mzDhOk';
                var CLIENT_ID = '17741540562-l3u3pptf45khhkpv103e7737imama9b1.apps.googleusercontent.com';

                // TODO: Authorize using one of the following scopes:
                //   'https://www.googleapis.com/auth/drive'
                //   'https://www.googleapis.com/auth/drive.file'
                //   'https://www.googleapis.com/auth/drive.readonly'
                //   'https://www.googleapis.com/auth/spreadsheets'
                //   'https://www.googleapis.com/auth/spreadsheets.readonly'
                var SCOPE = 'https://www.googleapis.com/auth/spreadsheets.readonly';

                gapi.client.init({
                    'apiKey': API_KEY,
                    'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
                    }).then(function() {
                    makeApiCall();
                });
            }
            function makeApiCall() {
                var params = {
                spreadsheetId: '1p-X4AaYuLH2ounIzjKPBYeyFtzlHUgLRh8Xqt3aMaAY',
                range: 'B17:H30',
                majorDimension: 'ROWS',
                };

                var request = gapi.client.sheets.spreadsheets.values.get(params);
                request.then(function(response) {
                    // TODO: Change code below to process the `response` object:
//                    console.log(response.result);
//                    console.log(response.result.values[0]);
                    updateTable(response.result.values);
                }, function(reason) {
                        console.error('error: ' + reason.result.error.message);
                });
            }
            function updateTable(data) {
//                console.log(data);
                //0:(7) ["저지드라", "기계병정 슬립킨크스", "", " 07일 14:04 ~ 07일 16:24", "", "", "66%"]
                //(4) ["드라구름", "아가 ▶실종◀ ", "", " 07일 07:10 ~      실종     "]
                
                var i;
                for(i = 0; i < data.length; i++)
                {
                    if(data[i].length == 7)
                        {
                            document.getElementById(String(alphabet[i]+1)).innerHTML = data[i][0];
                            document.getElementById(String(alphabet[i]+2)).innerHTML = data[i][1];
                            document.getElementById(String(alphabet[i]+3)).innerHTML = data[i][6];
                        }
                    else if(data[i].length == 4)
                        {// 실종마물
                            document.getElementById(String(alphabet[i]+1)).innerHTML = data[i][0];
                            document.getElementById(String(alphabet[i]+2)).innerHTML = data[i][1].replace(" ▶실종◀","");
                            document.getElementById(String(alphabet[i]+3)).innerHTML = "실종";
                        }
                }
            }
            
            setInterval(initClient, 30000);
        </script>
    <div><input type="button" onclick="initClient();" value="수동갱신" /></div>
    <div>
        <table class="tg" style="width: 100%">
        <colgroup>
        <col style="width: 15%;">
        <col style="width: 80%;">
        <col style="width: 5%;">
        </colgroup>
          <tr>
            <th class="tg-4a1m" colspan="3">A급 마물 시간표</th>
          </tr>
          <tr>
            <td class="tg-s2sm" id='A1'></td>
            <td class="tg-s2sm" id='A2'></td>
            <td class="tg-s2sm" id='A3'></td>
          </tr>
          <tr>
            <td class="tg-4a1m" id='B1'></td>
            <td class="tg-4a1m" id='B2'></td>
            <td class="tg-4a1m" id='B3'></td>
          </tr>
          <tr>
            <td class="tg-s2sm" id='C1'></td>
            <td class="tg-s2sm" id='C2'></td>
            <td class="tg-s2sm" id='C3'></td>
          </tr>
          <tr>
            <td class="tg-4a1m" id='D1'></td>
            <td class="tg-4a1m" id='D2'></td>
            <td class="tg-4a1m" id='D3'></td>
          </tr>
          <tr>
            <td class="tg-s2sm" id='E1'></td>
            <td class="tg-s2sm" id='E2'></td>
            <td class="tg-s2sm" id='E3'></td>
          </tr>
          <tr>
            <td class="tg-4a1m" id='F1'></td>
            <td class="tg-4a1m" id='F2'></td>
            <td class="tg-4a1m" id='F3'></td>
          </tr>
          <tr>
            <td class="tg-s2sm" id='G1'></td>
            <td class="tg-s2sm" id='G2'></td>
            <td class="tg-s2sm" id='G3'></td>
          </tr>
          <tr>
            <td class="tg-4a1m" id='H1'></td>
            <td class="tg-4a1m" id='H2'></td>
            <td class="tg-4a1m" id='H3'></td>
          </tr>
          <tr>
            <td class="tg-s2sm" id='I1'></td>
            <td class="tg-s2sm" id='I2'></td>
            <td class="tg-s2sm" id='I3'></td>
          </tr>
          <tr>
            <td class="tg-4a1m" id='J1'></td>
            <td class="tg-4a1m" id='J2'></td>
            <td class="tg-4a1m" id='J3'></td>
          </tr>
          <tr>
            <td class="tg-s2sm" id='K1'></td>
            <td class="tg-s2sm" id='K2'></td>
            <td class="tg-s2sm" id='K3'></td>
          </tr>
          <tr>
            <td class="tg-4a1m" id='L1'></td>
            <td class="tg-4a1m" id='L2'></td>
            <td class="tg-4a1m" id='L3'></td>
          </tr>
          <tr>
            <td class="tg-s2sm" id='M1'></td>
            <td class="tg-s2sm" id='M2'></td>
            <td class="tg-s2sm" id='M3'></td>
          </tr>
          <tr>
            <td class="tg-4a1m" id='N1'></td>
            <td class="tg-4a1m" id='N2'></td>
            <td class="tg-4a1m" id='N3'></td>
          </tr>
        </table>
    </div>
    </body>
</html>
